<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PP434 Project - Gabriel Costa</title>

    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <link rel="stylesheet" type="text/css" href="Example3.css"> 
</head>

<body>
    <nav style="margin-bottom: 20px;">
        <a href="Portfolio.html" style="text-decoration: none; font-weight: bold; color: #003366;">← Go to Portfolio</a>
    </nav>

    <header>
        <h1>Poverty and Labor Markets: Analyzing Employment as a Pathway to Economic Recovery in Brazil</h1>
        <p style="font-style: italic;">By Gabriel Costa | LSE Master of Public Policy</p>
    </header>
    
    <main>
        <section id="Aims">
            <h2>Aims</h2>
            <p>
                This project investigates the relationship between labor market participation and poverty reduction in Brazilian state capitals. 
                The central hypothesis is that employability serves as a primary driver for overcoming extreme poverty. 
            </p>
        </section>

        <hr>
        
        <article class="chart-container">
            <h3>Chart 1: Counterfactual to Maranhão: Piauí and Parallel Trends</h3>
            <p>The visual analysis reveals a robust Parallel Trends alignment prior to 2016. However, the 'Null Result' after the policy shock suggests structural resistance.</p>
            <div id="Chart1"></div>
        </article>

        <hr>

        <article class="chart-container">
            <h3>Chart 2: The Structural Trap: Sanitation vs. Poverty</h3>
            
            <p>
                While Chart 1 showed stable trends, Chart 2 explains the <strong>structural divide</strong>. 
                Using an <em>Ordinary Least Squares (OLS)</em> regression line, we observe a clear negative correlation between infrastructure and poverty. 
                Maranhão (Blue) is clustered in a high-poverty, low-sanitation zone, while Piauí (Red) has transitioned to a higher baseline of services. 
                This suggests that employment policies alone may face a 'bottleneck' if basic infrastructure is not improved simultaneously.
            </p>

            <div id="Chart2"></div>
        </article>

        <hr>

        <section id="Tools">
            <h2>Tools</h2>
            <p>Data was processed using <strong>Python (Pandas)</strong> and visualisations built with <strong>Vega-Lite</strong>.</p>
        </section>
    </main>

    <script>
        // --- CHART 1 ---
        let spec1 = {
          "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
          "title": {
            "text": "The Impact of Employability Policies on Poverty",
            "subtitle": "Difference-in-Differences: Maranhão vs Piauí.",
            "anchor": "start"
          },
          "data": { "url": "data/did_analysis_data.json" },
          "width": 600,
          "height": 400,
          "layer": [
            {
              "mark": {"type": "line", "point": true, "strokeWidth": 3},
              "encoding": {
                "x": {"field": "Year", "type": "ordinal", "title": "Year"},
                "y": {"field": "Poverty_Rate", "type": "quantitative", "scale": {"zero": false}},
                "color": {"field": "State", "type": "nominal", "scale": {"range": ["#003366", "#d62728"]}}
              }
            },
            {
              "mark": {"type": "rule", "color": "black", "strokeDash": [4,4]},
              "encoding": {"x": {"datum": 2016}}
            }
          ]
        };
        vegaEmbed('#Chart1', spec1).catch(console.error);

        // --- CHART 2 (With OLS Regression) ---
        let spec2 = {
          "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
          "title": {
            "text": "Structural Barriers: Sanitation vs. Poverty",
            "subtitle": "Linear regression (OLS) showing the correlation between infrastructure and poverty.",
            "anchor": "start"
          },
          "data": { "url": "data/multidimensional_poverty.json" },
          "width": 600,
          "height": 400,
          "layer": [
            {
              "mark": {"type": "point", "filled": true, "size": 100},
              "encoding": {
                "x": {"field": "Sanitation_Access", "type": "quantitative", "title": "Access to Sewage Network (%)", "scale": {"zero": false}},
                "y": {"field": "Poverty_Rate", "type": "quantitative", "title": "Poverty Rate (%)", "scale": {"zero": false}},
                "color": {"field": "State", "type": "nominal", "scale": {"range": ["#003366", "#d62728"]}},
                "tooltip": [{"field": "State"}, {"field": "Year"}, {"field": "Poverty_Rate"}]
              }
            },
            {
              "mark": {"type": "line", "color": "gray", "strokeDash": [4,4]},
              "transform": [{"regression": "Poverty_Rate", "on": "Sanitation_Access"}],
              "encoding": {
                "x": {"field": "Sanitation_Access", "type": "quantitative"},
                "y": {"field": "Poverty_Rate", "type": "quantitative"}
              }
            }
          ],
          "config": {"view": {"stroke": null}, "font": "Arial"}
        };
        vegaEmbed('#Chart2', spec2).catch(console.error);

    </script>
</body>
</html>